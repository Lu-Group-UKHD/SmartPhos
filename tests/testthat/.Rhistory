sample_data <- data.frame(sample = colnames(assay_data),
sampleType = rep(c("FullProteome", "Phospho"), each = 5),
group = rep(c("A", "B"), each = 5))
rownames(sample_data) <- colnames(assay_data)
# Create gene metadata
gene_data <- data.frame(UniprotID = rownames(assay_data),
Gene = paste0("gene", 1:100),
site = paste0("site", 1:10))
rownames(gene_data) <- rownames(assay_data)
# Create SummarizedExperiment object
se <- SummarizedExperiment(assays = list(Intensity = assay_data), colData = sample_data, rowData = gene_data)
result <- clusterEnrich(
clusterTab = mock_clusterTab,
se = se,
inputSet = mock_inputSet
)
result
result
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
mock_clusterTab
result$table$cluster
result$table
mock_inputSet <- list(
gsc = list(
pathway1 = c("gene1", "gene2", "gene3"),
pathway2 = c("gene6", "gene7", "gene8")
)
)
result <- clusterEnrich(
clusterTab = mock_clusterTab,
se = se,
inputSet = mock_inputSet
)
result
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
mock_inputSet <- list(
gsc = list(
pathway1 = c("gene1", "gene2", "gene3", "gene4"),
pathway2 = c("gene6", "gene7", "gene8")
)
)
result <- clusterEnrich(
clusterTab = mock_clusterTab,
se = se,
inputSet = mock_inputSet
)
result
mock_inputSet <- list(
gsc = list(
pathway1 = c("gene1", "gene2", "gene3", "gene4", "gene9"),
pathway2 = c("gene6", "gene7", "gene8")
)
)
result <- clusterEnrich(
clusterTab = mock_clusterTab,
se = se,
inputSet = mock_inputSet
)
result
mock_inputSet <- list(
gsc = list(
pathway1 = c("gene1", "gene2", "gene3", "gene9"),
pathway2 = c("gene6", "gene7", "gene8")
)
)
result <- clusterEnrich(
clusterTab = mock_clusterTab,
se = se,
inputSet = mock_inputSet
)
result
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
result <- clusterEnrich(
clusterTab = mock_clusterTab,
se = se,
inputSet = mock_inputSet,
reference = NULL
)
unique(se$rowData$Gene)
se$rowData
rowData(se)
rowData(se)$Gene
sort(mock_reference)
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
inputSet <- data.frame(
category = c(rep("CATEGORY1", 25), rep("KINASE", 5)), # 30 rows
site.ptm = c(rep("p", 25), rep("other", 5)),
signature = c(rep("Sig1", 10), rep("Sig2", 10), rep("Sig3", 10)),
site.direction = c(rep("u", 5), rep("d", 5), rep("u", 5), rep("d", 5), rep("u", 5), rep("d", 5)),
site.annotation = paste0("site", 1:30)
)
result <- clusterEnrich(
clusterTab = mock_clusterTab,
se = se,
inputSet = inputSet,
ptm = TRUE
)
result
rowData(se)
result$table
mock_clusterTab <- data.frame(
feature = paste0("site", 1:10),
cluster = rep(1:2, each = 5)
)
result <- clusterEnrich(
clusterTab = mock_clusterTab,
se = se,
inputSet = inputSet,
ptm = TRUE
)
result
mock_clusterTab
mock_clusterTab <- data.frame(
feature = paste0("gene", 1:10),
cluster = rep(1:2, each = 5)
)
result <- clusterEnrich(
clusterTab = mock_clusterTab,
se = se,
inputSet = inputSet,
ptm = TRUE
)
result
inputSet <- data.frame(
category = c(rep("CATEGORY1", 25), rep("KINASE", 5)), # 30 rows
site.ptm = c(rep("p", 25), rep("other", 5)),
signature = c(rep("Sig1", 5), rep("Sig2", 10), rep("Sig3", 15)),
site.direction = c(rep("u", 5), rep("d", 5), rep("u", 5), rep("d", 5), rep("u", 5), rep("d", 5)),
site.annotation = paste0("site", 1:30)
)
result <- clusterEnrich(
clusterTab = mock_clusterTab,
se = se,
inputSet = inputSet,
ptm = TRUE
)
result
mock_clusterTab <- data.frame(
feature = paste0("gene", 1:15),
cluster = c(rep("cluster1", 5), rep("clutser2", 10))
)
result <- clusterEnrich(
clusterTab = mock_clusterTab,
se = se,
inputSet = inputSet,
ptm = TRUE
)
result
mock_clusterTab <- data.frame(
feature = paste0("gene", 1:15),
cluster = c(rep("cluster1", 10), rep("clutser2", 5))
)
inputSet <- data.frame(
category = c(rep("CATEGORY1", 25), rep("KINASE", 5)), # 30 rows
site.ptm = c(rep("p", 25), rep("other", 5)),
signature = c(rep("Sig1", 5), rep("Sig2", 10), rep("Sig3", 15)),
site.direction = c(rep("u", 5), rep("d", 5), rep("u", 5), rep("d", 5), rep("u", 5), rep("d", 5)),
site.annotation = paste0("site", 1:30)
)
result <- clusterEnrich(
clusterTab = mock_clusterTab,
se = se,
inputSet = inputSet,
ptm = TRUE
)
result
mock_clusterTab <- data.frame(
feature = paste0("gene", 1:20),
cluster = c(rep("cluster1", 10), rep("clutser2", 10))
)
result <- clusterEnrich(
clusterTab = mock_clusterTab,
se = se,
inputSet = inputSet,
ptm = TRUE
)
result
mock_clusterTab <- data.frame(
feature = paste0("gene", 1:5),
cluster = c(rep("cluster1", 5), rep("clutser2", 5))
)
inputSet <- data.frame(
category = c(rep("CATEGORY1", 25), rep("KINASE", 5)), # 30 rows
site.ptm = c(rep("p", 25), rep("other", 5)),
signature = c(rep("Sig1", 5), rep("Sig2", 10), rep("Sig3", 15)),
site.direction = c(rep("u", 5), rep("d", 5), rep("u", 5), rep("d", 5), rep("u", 5), rep("d", 5)),
site.annotation = paste0("site", 1:30)
)
result <- clusterEnrich(
clusterTab = mock_clusterTab,
se = se,
inputSet = inputSet,
ptm = TRUE
)
result
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
use_test()
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
load_all()
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
load_all()
getDecouplerNetwork("Homo sapiens")
load_all()
getDecouplerNetwork("Homo sapiens")
load_all()
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
scoreTab_all_sig <- data.frame(
source = c("Kinase1", "Kinase2", "Kinase3"),
score = c(1.2, -2.3, 0.7),
p_value = c(0.01, 0.02, 0.03)
)
plot <- plotKinaseDE(scoreTab_all_sig, pCut = 0.05)
plot
scoreTab <- data.frame(
source = c("Kinase1", "Kinase2", "Kinase3", "Kinase4", "Kinase5"),
score = c(2.3, -1.5, 0, 3.1, -2.8),
p_value = c(0.01, 0.2, 0.05, 0.03, 0.04)
)
plot <- plotKinaseDE(scoreTab)
plot
scoreTab_zero <- data.frame(
source = c("Kinase1", "Kinase2", "Kinase3"),
score = c(0, 0, 0),
p_value = c(0.01, 0.02, 0.03)
)
plot <- plotKinaseDE(scoreTab_zero)
scoreTab_zero <- data.frame(
source = c("Kinase1", "Kinase2", "Kinase3"),
score = c(0, 0, 0),
p_value = c(0.01, 0.02, 0.03)
)
plot <- plotKinaseDE(scoreTab_zero)
scoreTab_zero <- data.frame(
source = c("Kinase1", "Kinase2", "Kinase3"),
score = c(0.03, 0.001, 0.2),
p_value = c(0.01, 0.02, 0.03)
)
plot <- plotKinaseDE(scoreTab_zero)
plot
scoreTab_zero <- data.frame(
source = c("Kinase1", "Kinase2", "Kinase3"),
score = c(0.03, 0.001, 2),
p_value = c(0.01, 0.02, 0.03)
)
plot <- plotKinaseDE(scoreTab_zero)
plot
scoreTab_zero <- data.frame(
source = c("Kinase1", "Kinase2", "Kinase3"),
score = c(3, 0, 2),
p_value = c(0.01, 0.02, 0.03)
)
plot <- plotKinaseDE(scoreTab_zero)
plot
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
load_all()
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
scoreTab <- data.frame(
timepoint = rep(c("0h", "1h", "2h"), each = 3),
source = rep(c("KinaseA", "KinaseB", "KinaseC"), times = 3),
score = c(1.2, -1.5, 0.8, -0.9, 1.5, -1.2, 0.6, -1.3, 1.8),
p_value = c(0.02, 0.06, 0.01, 0.04, 0.07, 0.03, 0.02, 0.08, 0.01)
)
p <- plotKinaseTimeSeries(scoreTab)
p
ggplot_build(p)
p1 <- ggplot_build(p)
p1$layout$coord
p1$layout
p1$layout$panel_scales_x
p1$layout$panel_scales_y
p1$layout$panel_scales$fill[[1]]
p1$layout$panel_scales$fill
p1$layout$panel_scales
p1$layout$get_scales
p1$layout$coord
p$scales
p$coordinates
p$scales
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
assays(se)
mat <- create_mock_data(rows = 10, cols = 6)
rows = 10
cols = 6
mat <- create_mock_data(rows = 10, cols = 6)
mat <- matrix(rnorm(rows * cols, mean = 5, sd = 2), nrow = rows, ncol = cols)
colnames(mat) <- paste0("Sample", 1:cols)
rownames(mat) <- paste0("Gene", 1:rows)
colData <- data.frame(timepoint=c("0min", "1h", "2h", "0min", "1h", "2h"),
treatment=c(rep("A", 3), rep("B", 3)),
subjectID=rep(1:2, each=3))
se <- SummarizedExperiment(assays=SimpleList(intensity=mat), colData=colData)
assays(se)
names(assays(se))
colDatase
colData
class(colData)
colData[,c(1:2)]
colData[c(1:2)]
colData[c(1:2),]
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
geneStat <- data.frame(stat = runif(100, -2, 2))
row.names(geneStat) <- paste0("Gene", 1:100)
ptmSetDb <- data.frame(signature = sample(letters[1:5], 100, replace = TRUE),
category = "example", site.ptm = "p",
site.direction = sample(c("u", "d"), 100, replace = TRUE),
site.annotation = paste("site", 1:100, sep = ":PMID"))
result <- runGSEAforPhospho(geneStat, ptmSetDb, nPerm = 100)
result
runApp('~/Documents/work/SmartPhos_app/SmartPhosExplorer')
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
runApp('~/Documents/work/SmartPhos_app/SmartPhosExplorer')
runApp('~/Documents/work/SmartPhos_app/SmartPhosExplorer')
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
rep(1, 5)
decoupler_network <- data.frame(
source = c("Kinase1", "Kinase1", "Kinase2", "Kinase3"),
mor = rep(1, 4),
target = c("S1", "S2", "S4", "S5"),
likelihood = rep(1, 4)
)
decoupler_network
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
print("resTab")
print(resTab)
runApp('~/Documents/work/SmartPhos_app/SmartPhosExplorer')
rep(1, 4)
c(rep(1, 4))
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
load_all()
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
load_all()
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
load_all()
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
runApp('~/Documents/work/SmartPhos_app/SmartPhosExplorer')
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
load_all()
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
load_all()
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
runApp('~/Documents/work/SmartPhos_app/SmartPhosExplorer')
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
data(read.table("omnipathR_kinase_network/Homo_sapiens.tsv", sep = "\t", stringsAsFactors = FALSE))
read.tabledata("omnipathR_kinase_network/Homo_sapiens.tsv", sep = "\t", stringsAsFactors = FALSE))
read.table(data("omnipathR_kinase_network/Homo_sapiens.tsv", sep = "\t", stringsAsFactors = FALSE))
?data
read.table("omnipathR_kinase_network/Homo_sapiens.tsv", sep = "\t", stringsAsFactors = FALSE))
read.table("omnipathR_kinase_network/Homo_sapiens.tsv", sep = "\t", stringsAsFactors = FALSE)
read.table("data/omnipathR_kinase_network/Homo_sapiens.tsv", sep = "\t", stringsAsFactors = FALSE)
read.table("./data/omnipathR_kinase_network/Homo_sapiens.tsv", sep = "\t", stringsAsFactors = FALSE)
read.table("../data/omnipathR_kinase_network/Homo_sapiens.tsv", sep = "\t", stringsAsFactors = FALSE)
read.table("/../data/omnipathR_kinase_network/Homo_sapiens.tsv", sep = "\t", stringsAsFactors = FALSE)
read.table("/Users/shubhamagrawal/Documents/work/SmartPhos/data/omnipathR_kinase_network", sep = "\t", stringsAsFactors = FALSE)
read.table("/Users/shubhamagrawal/Documents/work/SmartPhos/omnipathR_kinase_network", sep = "\t", stringsAsFactors = FALSE)
load("/Users/shubhamagrawal/Documents/work/SmartPhos/data/swissProt.RData")
swissProt
swiss <- load("/Users/shubhamagrawal/Documents/work/SmartPhos/data/swissProt.RData")
swiss
swiss <- swissProt
swiss
decouple_network <- read.table("/Users/shubhamagrawal/Documents/work/SmartPhos_app/SmartPhosExplorer/omnipathR_kinase_network/Homo_sapiens.tsv", sep = "\t", stringsAsFactors = FALSE)
decouple_network
save(decouple_network, file = "Homo_sapiens.RData")
decouple_network <- read.table("/Users/shubhamagrawal/Documents/work/SmartPhos_app/SmartPhosExplorer/omnipathR_kinase_network/Mus_musculus.tsv", sep = "\t", stringsAsFactors = FALSE)
save(decouple_network, file = "Mus_musculus.RData")
load_all()
decouple_network <- getDecouplerNetwork("Mus_musculus")
data("Homo_sapiens")
decouple_network <- getDecouplerNetwork("Mus musculus")
load("/Users/shubhamagrawal/Documents/work/SmartPhos/data/Homo_sapiens.RData")
load_all()
decouple_network <- getDecouplerNetwork("Mus musculus")
load("/Users/shubhamagrawal/Documents/work/SmartPhos/data/swissProt.RData")
load("/Users/shubhamagrawal/Documents/work/SmartPhos/data/Mus_musculus.RData")
View(decouple_network)
load("/Users/shubhamagrawal/Documents/work/SmartPhos/data/Homo_sapiens.RData")
load_all()
decouple_network <- getDecouplerNetwork("Mus musculus")
load_all()
decouple_network <- getDecouplerNetwork("Mus musculus")
decoupler_network <- getDecouplerNetwork("Mus musculus")
View(decoupler_network)
View(decouple_network)
Homo_sapiens <- read.table("/Users/shubhamagrawal/Documents/work/SmartPhos_app/SmartPhosExplorer/omnipathR_kinase_network/Homo_sapiens.tsv", sep = "\t", stringsAsFactors = FALSE)
Mus_musculus <- read.table("/Users/shubhamagrawal/Documents/work/SmartPhos_app/SmartPhosExplorer/omnipathR_kinase_network/Mus_musculus.tsv", sep = "\t", stringsAsFactors = FALSE)
save(Homo_sapiens, file = "Homo_sapiens.RData")
save(Mus_musculus, file = "Mus_musculus.RData")
load_all()
decoupler_network <- getDecouplerNetwork("Mus musculus")
decouple_network <- getDecouplerNetwork("Homo sapiens")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
runApp('~/Documents/work/SmartPhos_app/SmartPhosExplorer')
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
load_all()
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
resTab <- data.frame(
site = c("EGFR_Y1172", "EGFR_Y1197", "EGFR_S1166", "ROCK2_S1374", "WASL_Y256", "GAB1_Y259", "ADD1_S586", "EPHA2_Y772", "PRKDC_T2638", "PRKDC_T2609", "PRKDC_S2612"),
stat = c(-10.038770, -5.945562, 5.773384, -7.303834, 5.585326, 5.971104, 5.199119, -5.169500, 5.130228, 5.407387, 4.493933),
log2FC = c(-2.6113343, -2.4858615, 1.0056629, -1.1561780, 1.6421145, 2.0296634, 1.3766283, -0.8531656, 1.0742881, 1.0042942, 1.0608129)
)
decoupler_network <- getDecouplerNetwork("Homo sapiens")
result <- calcKinaseScore(resTab, decoupler_network)
View(decoupler_network)
rlang::last_trace()
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
decoupler_network <- data.frame(
source = c(rep("ABL1"), 11),
mor = c(rep(1, 11)),
target = c("EGFR_Y1172", "EGFR_Y1197", "EGFR_S1166", "ROCK2_S1374", "WASL_Y256", "GAB1_Y259", "ADD1_S586", "EPHA2_Y772", "PRKDC_T2638", "PRKDC_T2609", "PRKDC_S2612"),
likelihood = c(rep(1, 11))
)
c(rep("ABL1"), 11)
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
load_all()
load_all()
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
resTab <- data.frame(
site = c("EGFR_Y1172", "EGFR_Y1197", "EGFR_S1166", "ROCK2_S1374", "WASL_Y256", "GAB1_Y259", "ADD1_S586", "EPHA2_Y772", "PRKDC_T2638", "PRKDC_T2609", "PRKDC_S2612"),
stat = c(-10.038770, -5.945562, 5.773384, -7.303834, 5.585326, 5.971104, 5.199119, -5.169500, 5.130228, 5.407387, 4.493933),
log2FC = c(-2.6113343, -2.4858615, 1.0056629, -1.1561780, 1.6421145, 2.0296634, 1.3766283, -0.8531656, 1.0742881, 1.0042942, 1.0608129)
)
decoupler_network <- data.frame(
source = c(rep("ABL1", 11)),
mor = c(rep(1, 11)),
target = c("EGFR_Y1172", "EGFR_Y1197", "EGFR_S1166", "ROCK2_S1374", "WASL_Y256", "GAB1_Y259", "ADD1_S586", "EPHA2_Y772", "PRKDC_T2638", "PRKDC_T2609", "PRKDC_S2612"),
likelihood = c(rep(1, 11))
)
result <- calcKinaseScore(resTab, decoupler_network)
result
decoupler_network <- data.frame(
source = c(rep("ABL1", 5), rep("CDK2", 6)),
mor = c(rep(1, 11)),
target = c("EGFR_Y1172", "EGFR_Y1197", "EGFR_S1166", "ROCK2_S1374", "WASL_Y256", "GAB1_Y259", "ADD1_S586", "EPHA2_Y772", "PRKDC_T2638", "PRKDC_T2609", "PRKDC_S2612"),
likelihood = c(rep(1, 11))
)
result <- calcKinaseScore(resTab, decoupler_network)
result
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
load_all()
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
result
result2 <- calcKinaseScore(resTab, decoupler_network, nPerm = 1000)
result2
result2 <- calcKinaseScore(resTab, decoupler_network, nPerm = 1000)
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-kinase_activity.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
geneStat <- data.frame(stat = runif(100, -2, 2))
row.names(geneStat) <- paste0("Gene", 1:100)
ptmSetDb <- data.frame(signature = sample(letters[1:5], 100, replace = TRUE),
category = "example", site.ptm = "p",
site.direction = sample(c("u", "d"), 100, replace = TRUE),
site.annotation = paste("site", 1:100, sep = ":PMID"))
result_rank <- runGSEAforPhospho(geneStat, ptmSetDb, nPerm = 100, correl.type = "rank")
result_z_score <- runGSEAforPhospho(geneStat, ptmSetDb, nPerm = 100, correl.type = "z.score")
result_rank
result_z_score
result <- runGSEAforPhospho(geneStat, ptmSetDb, nPerm = 100)
result
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
runApp('~/Documents/work/SmartPhos_app/SmartPhosExplorer')
?source
runApp('~/Documents/work/SmartPhos_app/SmartPhosExplorer')
load_all()
load_all()
load_all()
load_all()
load_all()
?shinyApp
load_all()
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
testthat::test_file(path = "/Users/shubhamagrawal/Documents/work/SmartPhos/tests/testthat/test-enrichment.R")
load_all()
load_all()
load_all()
load_all()
shinySmartPhos()
load_all()
